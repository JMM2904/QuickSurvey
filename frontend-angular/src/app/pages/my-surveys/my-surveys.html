<div class="dashboard-container">
  
  <app-sidebar [activeRoute]="activeRoute"></app-sidebar>

  
  <main class="main-content">
    <div class="content-wrapper">
      <header class="page-header">
        <h1 class="page-title">Mis encuestas</h1>
      </header>

      
      <section class="search-section">
        <div class="search-bar">
          <svg
            class="search-icon"
            xmlns="http://www.w3.org/2000/svg"
            width="20"
            height="20"
            viewBox="0 0 256 256"
          >
            <path
              fill="currentColor"
              d="M232.49 215.51L185 168a92.12 92.12 0 1 0-17 17l47.53 47.54a12 12 0 0 0 17-17ZM44 112a68 68 0 1 1 68 68a68.07 68.07 0 0 1-68-68"
            />
          </svg>
          <input
            type="text"
            class="search-input"
            placeholder="Buscar encuestas..."
            [(ngModel)]="searchQuery"
            (input)="onSearchChange()"
          />
        </div>
      </section>

      
      <section class="surveys-grid">
        <div class="survey-card" *ngFor="let survey of paginatedSurveys">
          <h3 class="survey-title">{{ survey.title }}</h3>

          <div class="survey-info">
            <div class="survey-votes">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 32 32">
                <path
                  fill="currentColor"
                  d="M8 5v16h16V5zm2 2h12v12H10zm9.3 2.9L15 14.2l-2.3-2.3l-1.4 1.5l3 3l.7.7l.7-.7l5-5zM2 19v8h2v-6h2v-2zm24 0v2h2v6h2v-8zM6 23v2h20v-2z"
                />
              </svg>
              <span>{{ getVotesCount(survey) }} {{ getVotesText(survey) }}</span>
            </div>

            <span class="survey-status" [class.active]="survey.is_active">
              {{ getStatusText(survey) }}
            </span>
          </div>

          <div class="survey-buttons">
            <button
              class="btn-share"
              (click)="shareLink(survey.id, $event)"
              title="Compartir enlace"
            >
              <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24">
                <path
                  fill="currentColor"
                  d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81c1.66 0 3-1.34 3-3s-1.34-3-3-3s-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65c0 1.61 1.31 2.92 2.92 2.92s2.92-1.31 2.92-2.92s-1.31-2.92-2.92-2.92"
                />
              </svg>
            </button>
            <button class="btn-view" (click)="viewSurvey(survey.id)">VER</button>
          </div>

          <button
            class="btn-toggle-status"
            (click)="toggleSurveyStatus(survey)"
            [class.reactivate]="!survey.is_active"
          >
            {{ survey.is_active ? 'Finalizar encuesta' : 'Reactivar encuesta' }}
          </button>

          <ng-container *ngIf="!survey.is_active">
            <button
              class="btn-delete"
              *ngIf="confirmingDeleteId !== survey.id"
              (click)="askDelete(survey.id)"
            >
              Eliminar
            </button>

            <div class="delete-confirm" *ngIf="confirmingDeleteId === survey.id">
              <span>¿Eliminar esta encuesta?</span>
              <div class="confirm-actions">
                <button class="btn-confirm" (click)="confirmDelete(survey)">Sí, eliminar</button>
                <button class="btn-cancel" (click)="cancelDelete()">Cancelar</button>
              </div>
            </div>
          </ng-container>
        </div>

        
        <div class="no-results" *ngIf="filteredSurveys.length === 0">
          <p>No tienes encuestas creadas</p>
        </div>
      </section>

      <section class="pagination" *ngIf="filteredSurveys.length > pageSize">
        <button class="page-btn" (click)="prevPage()" [disabled]="currentPage === 1">
          ← Anterior
        </button>
        <span class="page-info">Página {{ currentPage }} de {{ totalPages }}</span>
        <button class="page-btn" (click)="nextPage()" [disabled]="currentPage === totalPages">
          Siguiente →
        </button>
      </section>
    </div>
  </main>
</div>

